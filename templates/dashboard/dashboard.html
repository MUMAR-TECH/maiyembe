{% extends 'dashboard/base.html' %}

{% block dashboard_content %}
<div class="dashboard-header">
    <h1>Dashboard Overview</h1>
    <a href="{% url 'core:service_create' %}" class="btn btn-primary">
        <i class="fas fa-plus"></i> Add New Service
    </a>
</div>

<!-- Statistics Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-icon primary">
            <i class="fas fa-hammer"></i>
        </div>
        <div class="stat-content">
            <h3>{{ services.count }}</h3>
            <p>Total Services</p>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon success">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-content">
            <h3>{{ services|length }}</h3>
            <p>Active Services</p>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon warning">
            <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
            <h3>{{ service_requests.count }}</h3>
            <p>Service Requests</p>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon info">
            <i class="fas fa-star"></i>
        </div>
        <div class="stat-content">
            <h3>{{ services|length }}</h3>
            <p>Featured Services</p>
        </div>
    </div>
</div>

<!-- Service Requests Section -->
<div class="service-requests" style="margin-bottom: 30px;">
    <div class="form-container">
        <h2 style="margin-bottom: 20px;">Recent Service Requests</h2>
        <div class="requests-list">
            {% for request in service_requests|slice:":5" %}
            <div class="request-card" style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                <div class="request-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h4 style="margin: 0; color: var(--text-dark);">{{ request.service.title|default:"General Inquiry" }}</h4>
                    <span class="request-date" style="color: var(--text-light); font-size: 0.9rem;">
                        {{ request.created_at|date:"M d, Y" }}
                    </span>
                </div>
                <div class="request-details">
                    <p style="margin-bottom: 8px;"><strong>From:</strong> {{ request.name }}</p>
                    <p style="margin-bottom: 8px;"><strong>Email:</strong> {{ request.email }}</p>
                    <p style="margin-bottom: 8px;"><strong>Phone:</strong> {{ request.phone }}</p>
                    <p style="margin-bottom: 0;"><strong>Message:</strong> {{ request.message|truncatewords:20 }}</p>
                </div>
                <div class="request-status" style="margin-top: 15px;">
                    <span class="badge {% if request.is_processed %}badge-success{% else %}badge-warning{% endif %}">
                        {% if request.is_processed %}Processed{% else %}Pending{% endif %}
                    </span>
                </div>
            </div>
            {% empty %}
            <p style="text-align: center; color: var(--text-light); padding: 40px;">No service requests yet.</p>
            {% endfor %}
        </div>
        {% if service_requests.count > 5 %}
        <div style="text-align: center; margin-top: 20px;">
            <a href="#" class="btn btn-secondary">View All Requests</a>
        </div>
        {% endif %}
    </div>
</div>

<!-- Services List -->
<div class="services-section">
    <h2 style="margin-bottom: 20px;">Your Services</h2>
    <div class="service-list">
        {% for service in services %}
        <div class="service-card">
            <div class="service-image">
                {% if service.image %}
                <img src="{{ service.image.url }}" alt="{{ service.title }}">
                {% else %}
                <div class="no-image">
                    <i class="fas fa-image"></i>
                </div>
                {% endif %}
            </div>
            <div class="service-info">
                <h3>{{ service.title }}</h3>
                <p class="service-category">{{ service.get_category_display }}</p>
                <div class="service-status">
                    <span class="badge {% if service.is_active %}badge-success{% else %}badge-secondary{% endif %}">
                        {% if service.is_active %}Active{% else %}Inactive{% endif %}
                    </span>
                    {% if service.is_featured %}
                    <span class="badge badge-primary">Featured</span>
                    {% endif %}
                </div>
                <p class="service-meta">
                    Created: {{ service.created_at|date:"M d, Y" }}<br>
                    Updated: {{ service.updated_at|date:"M d, Y" }}
                </p>
            </div>
            <div class="service-actions">
                <a href="{% url 'core:service_update' service.pk %}" class="btn btn-sm btn-edit">
                    <i class="fas fa-edit"></i> Edit
                </a>
                <a href="{% url 'core:service_delete' service.pk %}" class="btn btn-sm btn-danger">
                    <i class="fas fa-trash"></i> Delete
                </a>
                <a href="{% url 'core:service_detail' service.slug %}" class="btn btn-sm btn-secondary" target="_blank">
                    <i class="fas fa-eye"></i> View
                </a>
            </div>
        </div>
        {% empty %}
        <div class="no-services" style="grid-column: 1 / -1; text-align: center; padding: 40px; background: white; border-radius: 12px;">
            <p style="margin-bottom: 20px; color: var(--text-light);">You haven't created any services yet.</p>
            <a href="{% url 'core:service_create' %}" class="btn btn-primary">
                <i class="fas fa-plus"></i> Create Your First Service
            </a>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}